<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

  <!--radix_placeholder_meta_tags-->
<title>measured.: nma</title>

<meta property="description" itemprop="description" content="Work in progress."/>


<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2020-09-06"/>
<meta property="article:created" itemprop="dateCreated" content="2020-09-06"/>
<meta name="article:author" content="Charles T. Gray"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="measured.: nma"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="Work in progress."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="measured."/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary"/>
<meta property="twitter:title" content="measured.: nma"/>
<meta property="twitter:description" content="Work in progress."/>

<!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Threshold Analysis as an Alternative to GRADE for Assessing Confidence in Guideline Recommendations Based on Network Meta-analyses;citation_publication_date=2019;citation_publisher=American College of Physicians;citation_volume=170;citation_doi=10.7326/M18-3542;citation_issn=0003-4819;citation_author=David M. Phillippo;citation_author=Sofia Dias;citation_author=Nicky J. Welton;citation_author=Deborah M. Caldwell;citation_author=Nichole Taske;citation_author=A.e. Ades"/>
  <meta name="citation_reference" content="citation_title=Multinma: Network meta-analysis of individual and aggregate data in stan;citation_publication_date=2020;citation_doi=10.5281/zenodo.3904454;citation_author=David M. Phillippo"/>
  <meta name="citation_reference" content="citation_title=Cochrane handbook for systematic reviews of interventions;citation_publication_date=2019;citation_publisher=John Wiley &amp; Sons;citation_author=Julian PT Higgins;citation_author=James Thomas;citation_author=Jacqueline Chandler;citation_author=Miranda Cumpston;citation_author=Tianjing Li;citation_author=Matthew J Page;citation_author=Vivian A Welch"/>
  <meta name="citation_reference" content="citation_title=Code::Proof: Prepare for Most Weather Conditions;citation_publication_date=2019;citation_doi=10.1007/978-981-15-1960-4_2;citation_author=Charles T. Gray"/>
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output","bibliography"]}},"value":[{"type":"character","attributes":{},"value":["nma"]},{"type":"character","attributes":{},"value":["Work in progress."]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Charles T. Gray"]},{"type":"character","attributes":{},"value":["https://github.com/softloud/onetimetrophybitch"]}]}]},{"type":"character","attributes":{},"value":["09-06-2020"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["references.bib"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["EMS82751-supplement-Threshold_analysis_code.zip","Headaches/Headaches data ARM LEVEL.txt","Headaches/Headaches data TRIAL LEVEL.txt","Headaches/Headaches posterior summaries.Rda","Headaches/Headaches thresholds - contrast level.R","Headaches/Headaches thresholds - study level.R","Headaches/study_rob_table.csv","nma_files/bowser-1.9.3/bowser.min.js","nma_files/distill-2.2.21/template.v2.js","nma_files/figure-html/norm plots-1.png","nma_files/figure-html/prior plots-1.png","nma_files/figure-html/prior plots-2.png","nma_files/figure-html/priorpost-1.png","nma_files/figure-html/unnamed-chunk-10-1.png","nma_files/figure-html/unnamed-chunk-11-1.png","nma_files/figure-html/unnamed-chunk-12-1.png","nma_files/figure-html/unnamed-chunk-12-2.png","nma_files/figure-html/unnamed-chunk-5-1.png","nma_files/figure-html/unnamed-chunk-6-1.png","nma_files/figure-html/unnamed-chunk-9-1.png","nma_files/figure-html5/network-1.png","nma_files/figure-html5/norm plots-1.png","nma_files/figure-html5/priorpost-1.png","nma_files/figure-html5/unnamed-chunk-10-1.png","nma_files/figure-html5/unnamed-chunk-11-1.png","nma_files/figure-html5/unnamed-chunk-12-1.png","nma_files/figure-html5/unnamed-chunk-12-2.png","nma_files/figure-html5/unnamed-chunk-3-1.png","nma_files/figure-html5/unnamed-chunk-4-1.png","nma_files/figure-html5/unnamed-chunk-5-1.png","nma_files/figure-html5/unnamed-chunk-6-1.png","nma_files/figure-html5/unnamed-chunk-7-1.png","nma_files/figure-html5/unnamed-chunk-8-1.png","nma_files/figure-html5/unnamed-chunk-9-1.png","nma_files/header-attrs-2.3/header-attrs.js","nma_files/jquery-1.11.3/jquery.min.js","nma_files/webcomponents-2.0.0/webcomponents.js","nma-3rd-draft_files/figure-html/unnamed-chunk-2-1.png","nma-3rd-draft_files/figure-html/unnamed-chunk-6-1.png","references.bib","Social Anxiety/Social Anxiety - contrast level.R","Social Anxiety/study data.txt"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-1.11.3/jquery.min.js"></script>
<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createFuseIndex() {

  // create fuse index
  var options = {
    keys: [
      { name: 'title', weight: 20 },
      { name: 'categories', weight: 15 },
      { name: 'description', weight: 10 },
      { name: 'contents', weight: 5 },
    ],
    ignoreLocation: true,
    threshold: 0
  };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
              ? `<img src="${offsetURL(suggestion.preview)}"</img>`
              : '';
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description || ''}
                </div>
                <div class="search-item-preview">
                  ${img}
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

.nav-search {
  font-size: x-small;
}

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  font-size: 1rem;
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure img {
  width: 100%;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme
  $('code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.3/header-attrs.js"></script>
  <script src="../../site_libs/jquery-1.11.3/jquery.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"nma","description":"Work in progress.","authors":[{"author":"Charles T. Gray","authorURL":"https://github.com/softloud/onetimetrophybitch","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2020-09-06T00:00:00.000+10:00","citationText":"Gray, 2020"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="../../index.html" class="title">measured.</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="../../index.html">measured.</a>
<a href="../../about.html">trophybitch</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
rethinking
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="../../rethinking/chapter-2.html">chapter-2</a>
</div>
</div>
<div class="nav-dropdown">
<button class="nav-dropbtn">
presentations
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="../../talks/nma-esmar/nma-esmar.html">esmar 2021 nmareporting::</a>
<a href="../../talks/sysrevdat/sysrevdat-talk.html">esmar 2021 sysrevdata::</a>
<a href="../../talks/hlf/hlf-2019-xaringan.html">hlf</a>
<a href="../../talks/newcastle-nma/newcastle-nma.html">nma pdoc application</a>
</div>
</div>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>nma</h1>
<p><p>Work in progress.</p></p>
</div>

<div class="d-byline">
  Charles T. Gray <a href="https://github.com/softloud/onetimetrophybitch" class="uri">https://github.com/softloud/onetimetrophybitch</a> 
  
<br/>09-06-2020
</div>

<div class="d-article">
<h3 class="d-toc-header">Table of Contents</h3>
<nav class="d-toc" id="TOC">
<ul>
<li><a href="#network-meta-analysis">network meta-analysis</a></li>
<li><a href="#thinking-through-the-theory">thinking through the theory</a>
<ul>
<li><a href="#linear-regression">linear regression</a></li>
<li><a href="#meta-regression">meta-regression</a></li>
<li><a href="#bayesian-network-meta-analysis">Bayesian network meta-analysis</a></li>
</ul></li>
<li><a href="#example-dataset-parkinsons_dat">example dataset: parkinsons_dat</a></li>
<li><a href="#network-meta-analysis-1">network meta-analysis</a></li>
<li><a href="#cochrane-reporting">cochrane reporting</a>
<ul>
<li><a href="#evidence-base-and-network-structure">evidence base and network structure</a></li>
<li><a href="#flow-of-evidence">flow of evidence</a>
<ul>
<li><a href="#contribution-matrix">contribution matrix</a></li>
</ul></li>
<li><a href="#results">results</a>
<ul>
<li><a href="#intervention-effects">intervention effects</a></li>
<li><a href="#rankograms">rankograms</a></li>
</ul></li>
</ul></li>
<li><a href="#threshold-analysis">threshold analysis</a></li>
<li><a href="#the-math-of-nma_thresh">the math of <code>::nma_thresh</code></a></li>
<li><a href="#nmathresh-example-social-anxiety"><code>nmathresh::</code> example: social anxiety</a></li>
<li><a href="#references">references</a></li>
</ul>
</nav>
<hr class="d-toc-separator"/>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
# last updated
Sys.Date()</code></pre>
<pre><code>
[1] &quot;2020-10-07&quot;</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
# packages used in this blogpost

# general purpose
library(tidyverse) 
library(kableExtra) # tables
library(skimr) # summary
library(patchwork) # vis + vis

# toolchain walkthrough
library(multinma) # network meta-analysis
library(nmathresh) # threshold analysis
library(metafor) # for (non network) meta-analysis

# special purpose
library(fdrtool) # for halfnormal distribution
library(simeta) # borrowing some handy functions 
# note: should port these to my helper functions pkg

# for reproducibility
set.seed(40)</code></pre>
</div>
<h1 id="network-meta-analysis">network meta-analysis</h1>
<p>Network meta-analysis is a statistical method for aggregating multiple pairwise comparisons on a response of interest <span class="citation" data-cites="higgins2019cochrane">(Higgins et al. <a href="#ref-higgins2019cochrane" role="doc-biblioref">2019</a>)</span>. For example, perhaps three studies propose different treatments for a particular medical condition, network meta-analysis enables us to directly and indirectly compare the treatments’ effects. Network meta-analysis is a technique for identifying <em>which</em> treatments are more effective than others, rather than <em>whether</em> a treatment is effective <span class="citation" data-cites="harrer_doingmetaanalysis_2019">(Harrer et al. <a href="#ref-harrer_doingmetaanalysis_2019" role="doc-biblioref">2019</a>)</span>.</p>
<p>In this toolchain walkthrough, an opinionated documentation of a scientific workflow <span class="citation" data-cites="gray_codeproofprepare_2019">(Gray <a href="#ref-gray_codeproofprepare_2019" role="doc-biblioref">2019</a>)</span>, I computationally step through the packages <code>multinma::</code> <span class="citation" data-cites="phillippo_multinmanetworkmetaanalysis_2020">(Phillippo <a href="#ref-phillippo_multinmanetworkmetaanalysis_2020" role="doc-biblioref">2020</a>)</span> and <code>nnathresh</code> <span class="citation" data-cites="phillippo_sensitivitytreatmentrecommendations_2018">(Phillippo et al. <a href="#ref-phillippo_sensitivitytreatmentrecommendations_2018" role="doc-biblioref">2018</a>)</span> for a network meta-analysis with threshold analysis.</p>
<h1 id="thinking-through-the-theory">thinking through the theory</h1>
<p>Bayesian network meta-analysis is a form of meta-analysis, and meta-analysis is form of linear regression. We solve for a line of best fit. How do we describe this particular line?</p>
<h2 id="linear-regression">linear regression</h2>
<p><span class="math display">\[
y \sim \text{normal}(BX, \sigma^2)
\]</span></p>
<h2 id="meta-regression">meta-regression</h2>
<p>For the <span class="math inline">\(k\)</span>th study’s effect, for a random effects model, we assume</p>
<p><span class="math display">\[
y_k \sim \text{normal}(\mu + u_k, \sigma_k^2)\\
u_k \sim \text{normal}(0, \tau^2)
\]</span></p>
<p>where <span class="math inline">\(\mu\)</span> represents the effect of interest and <span class="math inline">\(u_k\)</span> the heterogeneity of the studies, with spread <span class="math inline">\(\tau^2\)</span>.</p>
<h2 id="bayesian-network-meta-analysis">Bayesian network meta-analysis</h2>
<p>A network meta-analysis relies on a transitivity assumption whereby indirect comparisons can be constructed from direct comparisons. That is, if we have direct comparisons <span class="math inline">\(\delta_{AC}\)</span> and <span class="math inline">\(\delta_{CB}\)</span>, we can construct an indirect comparison of differences <span class="citation" data-cites="lumley_networkmetaanalysisindirect_2002">(Lumley <a href="#ref-lumley_networkmetaanalysisindirect_2002" role="doc-biblioref">2002</a>)</span>. <span class="math display">\[
\delta_{AB} = \delta_{AC} + \delta_{CB}
\]</span></p>
<p>Using this, analogously to <span class="math inline">\(BX\)</span> a coefficients are found for all treatment effects, relative to a control or placebo.</p>
<p>Lumley characterises the structure of the model for three treatments <span class="citation" data-cites="lumley_networkmetaanalysisindirect_2002">(Lumley <a href="#ref-lumley_networkmetaanalysisindirect_2002" role="doc-biblioref">2002</a>)</span>. For the <span class="math inline">\(k\)</span>th study’s treatments <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>, measured by <span class="math inline">\(Y_{ijk}\)</span>, true average effects <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\eta\)</span> capturing the heterogeneity of the treatment effect, with <span class="math inline">\(\zeta\)</span> denoting a change in the effect of treatment <span class="math inline">\(i\)</span> when it is compared to <span class="math inline">\(j\)</span><br />
<span class="math display">\[
Y_{ijk} \sim \text{normal}(\mu_i - \mu_j + \eta_{ik} + \eta_{jk} + \zeta_{ij}, \sigma^2_{ijk})\\
\eta_{ij} \sim \text{normal}(0, \tau^2)\\
\zeta_{ij} \sim \text{normal}(0, \omega^2)
\]</span> This statement lays out the basic structure clearest for me, especially where heterogeneity <span class="math inline">\(\tau^2\)</span> and incoherence <span class="math inline">\(\omega\)</span> sit in the structure.</p>
<p>Since <code>multinma::</code> provides tools for Bayesian network meta-analysis, our computational model solves for the posterior <span class="citation" data-cites="statrethinkingbook">(McElreath <a href="#ref-statrethinkingbook" role="doc-biblioref">2016</a>)</span>, providing the probability of the parameter of interest, <span class="math inline">\(\theta\)</span>, given the data, <span class="math inline">\(x\)</span>, <span class="math display">\[
P(\theta|x) = \frac{P(x|\theta)P(\theta)}{P(x)}.
\]</span> We get the distributions of the mean value of the parameters, the non-data bits, of the model.</p>
<p>And, using the nomeclature of the documentation in <code>::nma_thresh</code>, for a fixed-effect model, we have prior <span class="math display">\[
d \sim \text{normal}(d_0, \Sigma_d)\\
\]</span> and likelihood <span class="math display">\[
y\ |\ d \sim \text{normal}(\delta, V)\\
\]</span> with fixed effect <span class="math display">\[
\delta = Xd 
\]</span></p>
<p>Now to explore this theory in action with an example network meta-analysis.</p>
<h1 id="example-dataset-parkinsons_dat">example dataset: parkinsons_dat</h1>
<p>We’ll use an example dataset from <code>multinma::</code> with seven studies’ results for pairwise comparisons of five treatments of interest for our continuous response measure,</p>
<blockquote>
<p>the mean off-time reduction in patients given dopamine agonists as adjunct therapy in Parkinson’s disease from 7 trials comparing four active drugs and placebo <span class="citation" data-cites="phillippo_multilevelnetworkmetaregression_2020 dias2011nice">(<code>?parkinsons</code> documentation; Phillippo et al. <a href="#ref-phillippo_multilevelnetworkmetaregression_2020" role="doc-biblioref">2020</a>; data source Dias et al. <a href="#ref-dias2011nice" role="doc-biblioref">2011</a>)</span>.</p>
</blockquote>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
# peek at the data
parkinsons %&gt;% 
  head(3)</code></pre>
<pre><code>
  studyn trtn     y    se   n  diff se_diff
1      1    1 -1.22 0.504  54    NA   0.504
2      1    3 -1.53 0.439  95 -0.31   0.668
3      2    1 -0.70 0.282 172    NA   0.282</code></pre>
<pre class="r"><code>
# just gon&#39; tweak it a li&#39;l so I can keep track of the variables
parkinsons_dat &lt;- 
  parkinsons %&gt;% 
  mutate(
    studyn = str_c(&quot;study_&quot;, studyn),
    trtn = str_c(&quot;trt_&quot;, trtn)
  )</code></pre>
</div>
<p>From <code>?parkinsons</code> documentation, we know we have a study variable <code>studyn</code>, a treatment variable <code>trtn</code>, a measure of effect <code>y</code>, and standard error of the effect, <code>se</code>, sample size <code>n</code>.</p>
<p>First step is to convert the raw data to a network object for contrast analysis.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
# create network object
parkinsons_net &lt;-
  set_agd_contrast(
    parkinsons_dat,
    study = studyn,
    trt = trtn,
    y = diff,
    se = se_diff,
    sample_size = n
  )

# this is a network object
parkinsons_net</code></pre>
<pre><code>
A network with 7 AgD studies (contrast-based).

---------------------------------------- AgD studies (contrast-based) ---- 
 Study   Treatments              
 study_1 2: trt_1 | trt_3        
 study_2 2: trt_1 | trt_2        
 study_3 3: trt_1 | trt_2 | trt_4
 study_4 2: trt_3 | trt_4        
 study_5 2: trt_3 | trt_4        
 study_6 2: trt_4 | trt_5        
 study_7 2: trt_4 | trt_5        

 Outcome type: continuous
--------------------------------------------------------------------------
Total number of treatments: 5
Total number of studies: 7
Reference treatment is: trt_4
Network is connected</code></pre>
</div>
<p>Now we’ve converted our data to a network object, we can inspect the direct and indirect evidence we have. That is which treatments have a pairwise comparison in at least one study.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
plot(parkinsons_net, weight_edges = FALSE)</code></pre>
<div class="figure"><span id="fig:network"></span>
<img src="nma_files/figure-html5/network-1.png" alt="This network of 7 studies contains direct and indirect (via transitivity) effects, with respect to treatment 4." width="624" />
<p class="caption">
Figure 1: This network of 7 studies contains direct and indirect (via transitivity) effects, with respect to treatment 4.
</p>
</div>
</div>
<p>We can see the model will be creating indirect comparisons between treatments such 2 and 3, using the direct evidence in studies that compare 1 and 3, as well as 1 and 2.</p>
<h1 id="network-meta-analysis-1">network meta-analysis</h1>
<p>We run the following code to fit a random-effects network meta-analysis model.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
nma_results &lt;-
  nma(parkinsons_net,
      trt_effects = &quot;fixed&quot;,
      prior_trt = normal(scale = 100))</code></pre>
</div>
<p>We assume a prior distribution on <span class="math inline">\(k = 1, \dots, 5\)</span> treatment effects <span class="math display">\[
d_k \sim \text{normal}(d_4, 100^2) 
\]</span> Since we assume a likelihood <span class="math display">\[
y\ |\ d \sim \text{normal}(\delta, V)\\
\]</span> with fixed effect <span class="math display">\[
\delta = Xd
\]</span> our model will give us estimates of <span class="math inline">\(d\)</span>, <span class="math inline">\(mu\)</span> and <span class="math inline">\(V\)</span>.</p>
<p>When we plot the posteriors and with their priors, we see estimates for the comparative difference of treatments from the placebo, treatment 4.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
plot_prior_posterior(nma_results)</code></pre>
<p><img src="nma_files/figure-html5/unnamed-chunk-3-1.png" width="624" /></p>
</div>
<p>We consider two ways of assessing the results of the model, the standards outlined in Cochrane’s <em>Handbook</em> <span class="citation" data-cites="higgins2019cochrane">(Higgins et al. <a href="#ref-higgins2019cochrane" role="doc-biblioref">2019</a>)</span> and threshold analysis <span class="citation" data-cites="phillippo_multinmanetworkmetaanalysis_2020">(Phillippo <a href="#ref-phillippo_multinmanetworkmetaanalysis_2020" role="doc-biblioref">2020</a>)</span>.</p>
<h1 id="cochrane-reporting">cochrane reporting</h1>
<p>Now, we have the a network meta-anlaysis, we turn to <a href="https://training.cochrane.org/handbook/current/chapter-11#section-11-6-4">11.6 of Cochrane handbook</a> for how to inspect the results of the model <span class="citation" data-cites="higgins2019cochrane">(Higgins et al. <a href="#ref-higgins2019cochrane" role="doc-biblioref">2019</a>)</span>.</p>
<h2 id="evidence-base-and-network-structure">evidence base and network structure</h2>
<p>For networks that do not have an overabundance of nodes, that is treatments, a plot of the network, as shown in Figure <a href="#fig:network">1</a> is enough. We can also inspect the network with a table.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
parkinsons_net</code></pre>
<pre><code>
A network with 7 AgD studies (contrast-based).

---------------------------------------- AgD studies (contrast-based) ---- 
 Study   Treatments              
 study_1 2: trt_1 | trt_3        
 study_2 2: trt_1 | trt_2        
 study_3 3: trt_1 | trt_2 | trt_4
 study_4 2: trt_3 | trt_4        
 study_5 2: trt_3 | trt_4        
 study_6 2: trt_4 | trt_5        
 study_7 2: trt_4 | trt_5        

 Outcome type: continuous
--------------------------------------------------------------------------
Total number of treatments: 5
Total number of studies: 7
Reference treatment is: trt_4
Network is connected</code></pre>
</div>
<h2 id="flow-of-evidence">flow of evidence</h2>
<p>Another way of summarising the evidence base of a network meta-analysis is a <strong>contribution matrix</strong>, as described in 11.6.3, however I have as yet to find this.</p>
<h3 id="contribution-matrix">contribution matrix</h3>
<blockquote>
<p>Haven’t found a tool for this. Might need to code one.</p>
</blockquote>
<h2 id="results">results</h2>
<h3 id="intervention-effects">intervention effects</h3>
<p>The credible intervals for each of the comparative treatment effects is of most interest, which we can inspect with a forest plot.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
plot(nma_results)</code></pre>
<p><img src="nma_files/figure-html5/unnamed-chunk-5-1.png" width="624" /></p>
</div>
<p>This would suggest the second treatment has the greatest effect. A table is also a useful summary.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
nma_results</code></pre>
<pre><code>
A fixed effects NMA with a normal likelihood (identity link).
Inference for Stan model: normal.
4 chains, each with iter=2000; warmup=1000; thin=1; 
post-warmup draws per chain=1000, total post-warmup draws=4000.

          mean se_mean   sd  2.5%   25%   50%   75% 97.5% n_eff Rhat
d[trt_1]  0.53    0.01 0.47 -0.39  0.22  0.53  0.83  1.46  2279    1
d[trt_2] -1.28    0.01 0.51 -2.28 -1.62 -1.27 -0.94 -0.29  2396    1
d[trt_3]  0.05    0.01 0.32 -0.59 -0.17  0.05  0.27  0.68  2688    1
d[trt_5] -0.30    0.00 0.20 -0.69 -0.43 -0.30 -0.16  0.11  3552    1
lp__     -3.09    0.03 1.41 -6.61 -3.79 -2.76 -2.04 -1.36  1807    1

Samples were drawn using NUTS(diag_e) at Wed Oct  7 20:56:12 2020.
For each parameter, n_eff is a crude measure of effective sample size,
and Rhat is the potential scale reduction factor on split chains (at 
convergence, Rhat=1).</code></pre>
</div>
<h3 id="rankograms">rankograms</h3>
<p>Another recommendation is to provide the ranking distributions of the different treatments.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
posterior_rank_probs(nma_results) %&gt;% 
  plot()</code></pre>
<p><img src="nma_files/figure-html5/unnamed-chunk-7-1.png" width="624" /></p>
</div>
<p>A nice feature of <code>multinma::</code> is that it provides cumulative ranking plots, which I think are bit easier to interpret. Here we see the second treatment has the greatest likelihood to be ranked the best treatment.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
posterior_rank_probs(nma_results, cumulative = TRUE) %&gt;% 
  plot()</code></pre>
<p><img src="nma_files/figure-html5/unnamed-chunk-8-1.png" width="624" /></p>
</div>
<h1 id="threshold-analysis">threshold analysis</h1>
<blockquote>
<p>Work in progress.</p>
</blockquote>
<p>Phillipo <em>et al.</em> claim threshold analysis provides a more robust method of assessing confidence in recommendations based on network meta-analysis than the widely-used [] GRADE framework <span class="citation" data-cites="phillippo_thresholdanalysisalternative_2019">(Phillippo et al. <a href="#ref-phillippo_thresholdanalysisalternative_2019" role="doc-biblioref">2019</a>)</span>. The typical results of a network meta-analysis is a ‘consistent set of treatment estimates so that coherent recommendations may be made’, however there are many reasons we may question the strength of the evidence. In the case of the parkinsons_dat dataset, we have an estimate of the laudifference of a particular treatment on the mean off-time reduction in patients given dopamine agonists as adjunct therapy, from the default treatment.</p>
<blockquote>
<p>Threshold analysis quantifies precisely how much the evidence could change (for any reason, such as potential biases or simply sampling variation) before the recommendation changes, and what the revised recommendation would be. If it is judged that the evidence could not plausibly change by more than this amount then the recommendation is considered robust, otherwise the recommendation is sensitive to plausible changes in the evidence <span class="citation" data-cites="phillippo_thresholdanalysisalternative_2019">(Phillippo et al. <a href="#ref-phillippo_thresholdanalysisalternative_2019" role="doc-biblioref">2019</a>)</span>.</p>
</blockquote>
<p>Threshold analyses are performed at both study level and at contrast level, in either case the result is a set of thresholds that show how much the data point can change before the recommendation changes. We will do a contrast-level threshold analysis on the parkinsons_dat dataset.</p>
<p><code>::nma_thresh</code> for random effects model require</p>
<ol type="1">
<li>the posterior means <code>means.dk</code> of the basic treatment parameters <span class="math inline">\(d_k\)</span>,</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
post_means &lt;- 
  summary(nma_results, pars=c(&quot;d&quot;)) %&gt;% 
  as.data.frame() %&gt;%
  pull(&quot;mean&quot;)</code></pre>
</div>
<ol start="2" type="1">
<li>a likelihood <code>lhood</code> covariance matrix,</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
# for lhood
likelihood_cov &lt;- 
  diag(parkinsons_dat$se^2)</code></pre>
</div>
<ol start="3" type="1">
<li>the posterior covariance matrix <code>post</code>, posterior covariance mtrix of the vector <span class="math inline">\((\delta^T, \sigma^T, \mu^T)^T\)</span></li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
# for posterior
post_cov &lt;-
  summary(nma_results, pars = c(&quot;d&quot;)) %&gt;% 
  as.data.frame() %&gt;% 
  pull(&quot;sd&quot;) %&gt;% 
  as.numeric() %&gt;% 
  map_dbl(.f = function(x){x^2}) %&gt;% 
  diag()</code></pre>
</div>
<ol start="4" type="1">
<li>a design matrix <code>mu.design</code> for additional covariates,</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
# a design matrix for mu.design
M &lt;- matrix(0, nrow = nrow(parkinsons_dat), ncol = 7)

for (i in 1:nrow(parkinsons_dat)) {
  if (parkinsons_dat$trtn[i]) M[i, parkinsons_dat$studyn[i]] &lt;- 1
}</code></pre>
</div>
<ol start="5" type="1">
<li>a design matrix <code>delta.design</code> for random effects terms.</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
# construct the design mtrix for eazch contrast
X &lt;- matrix(0, nrow = 15, ncol = 6)

for (i in 1:15){
  X[i, parkinsons_dat$trtn[i]-1] &lt;- 1
  if (parkinsons_dat$studyn[i] != 4){
    X[i, parkinsons_dat$studyn[i]-1] &lt;- -1
  }
}</code></pre>
</div>
<p>With these inputs, we construct a threshold object.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
# unfortunately this code throws an error
# indicating the construction of the posterior covariance matrix is not correct
thresh &lt;- 
  nma_thresh(
    mean.dk = post_means,
    lhood = likelihood_cov,
    post= post_cov,
    X = X,
    nmatype = &quot;fixed&quot;
  )</code></pre>
<pre><code>
Error in nma_thresh(mean.dk = post_means, lhood = likelihood_cov, post = post_cov, : object &#39;X&#39; not found</code></pre>
</div>
<p>It will take some more study to figure out how to do a threshold analysis. So, I’ll toolchain walkthrough, an opinionated documentation of a scientific workflow <span class="citation" data-cites="gray_codeproofprepare_2019">(Gray <a href="#ref-gray_codeproofprepare_2019" role="doc-biblioref">2019</a>)</span>, through the vignette for threshold analysis, and try to connect it to the structure of the model as mathematical objects. Already I can see the dimensions of the matrices I constructed are not correct.</p>
<h1 id="the-math-of-nma_thresh">the math of <code>::nma_thresh</code></h1>
<p>Prior:</p>
<p><span class="math display">\[
d \sim N(d_0, \Sigma_d)
\]</span> Likelihood: <span class="math display">\[
y | d \sim N(\delta, V)
\]</span> FE model: <span class="math display">\[
\delta = Xd + M\mu
\]</span> Which components of these do we need for the threshold analysis?</p>
<ol type="1">
<li>the posterior means <code>means.dk</code> of the basic treatment parameters <span class="math inline">\(d_k\)</span></li>
</ol>
<blockquote>
<p>So that would be the <span class="math inline">\(d\)</span> in <span class="math inline">\(\delta = Xd + M\mu\)</span>?</p>
</blockquote>
<ol start="2" type="1">
<li></li>
</ol>
<h1 id="nmathresh-example-social-anxiety"><code>nmathresh::</code> example: social anxiety</h1>
<p>In this section, I toolchain walkthrough through the code provided as an example in Phillipo <em>et al.</em>’s threshold analysis manuscript <span class="citation" data-cites="phillippo_thresholdanalysisalternative_2019">(Phillippo et al. <a href="#ref-phillippo_thresholdanalysisalternative_2019" role="doc-biblioref">2019</a>)</span>.</p>
<p>The data provided are from a network meta-analysis of social anxiety with 41 treatments in 17 classes over 100 studies.</p>
<ol type="1">
<li>the posterior means <code>means.dk</code> of the basic treatment parameters <span class="math inline">\(d_k\)</span>,</li>
</ol>
<h1 class="unnumbered" id="references" class="unnumbered">references</h1>
<div id="refs" class="references hanging-indent" role="doc-bibliography">
<div id="ref-dias2011nice">
<p>Dias, Sofia, Nicky J Welton, Alex J Sutton, and AE Ades. 2011. “NICE Dsu Technical Support Document 2: A Generalised Linear Modelling Framework for Pairwise and Network Meta-Analysis of Randomised Controlled Trials.”</p>
</div>
<div id="ref-gray_codeproofprepare_2019">
<p>Gray, Charles T. 2019. “Code::Proof: Prepare for Most Weather Conditions.” Edited by Hien Nguyen. <em>Statistics and Data Science</em>, Communications in Computer and Information Science,, 22–41. <a href="https://doi.org/10.1007/978-981-15-1960-4_2">https://doi.org/10.1007/978-981-15-1960-4_2</a>.</p>
</div>
<div id="ref-harrer_doingmetaanalysis_2019">
<p>Harrer, Mathias, Prof Dr Pim Cuijpers², Prof Dr Toshi A. Furukawa³, and Assoc Prof Dr David D. Ebert². 2019. <em>Doing Meta-Analysis in R</em>. <a href="https://bookdown.org/MathiasHarrer/Doing_Meta_Analysis_in_R/">https://bookdown.org/MathiasHarrer/Doing_Meta_Analysis_in_R/</a>.</p>
</div>
<div id="ref-higgins2019cochrane">
<p>Higgins, Julian PT, James Thomas, Jacqueline Chandler, Miranda Cumpston, Tianjing Li, Matthew J Page, and Vivian A Welch. 2019. <em>Cochrane Handbook for Systematic Reviews of Interventions</em>. John Wiley &amp; Sons.</p>
</div>
<div id="ref-lumley_networkmetaanalysisindirect_2002">
<p>Lumley, Thomas. 2002. “Network Meta-Analysis for Indirect Treatment Comparisons.” <em>Statistics in Medicine</em> 21 (16): 2313–24. <a href="https://doi.org/10.1002/sim.1201">https://doi.org/10.1002/sim.1201</a>.</p>
</div>
<div id="ref-statrethinkingbook">
<p>McElreath, Richard. 2016. <em>Statistical Rethinking: A Bayesian Course with Examples in R and Stan</em>. CRC Press. <a href="http://xcelab.net/rm/statistical-rethinking/">http://xcelab.net/rm/statistical-rethinking/</a>.</p>
</div>
<div id="ref-phillippo_multinmanetworkmetaanalysis_2020">
<p>Phillippo, David M. 2020. <em>Multinma: Network Meta-Analysis of Individual and Aggregate Data in Stan</em>. Manual. <a href="https://doi.org/10.5281/zenodo.3904454">https://doi.org/10.5281/zenodo.3904454</a>.</p>
</div>
<div id="ref-phillippo_multilevelnetworkmetaregression_2020">
<p>Phillippo, David M., Sofia Dias, A. E. Ades, Mark Belger, Alan Brnabic, Alexander Schacht, Daniel Saure, Zbigniew Kadziola, and Nicky J. Welton. 2020. “Multilevel Network Meta-Regression for Population-Adjusted Treatment Comparisons.” <em>Journal of the Royal Statistical Society: Series A (Statistics in Society)</em> 183 (3): 1189–1210. <a href="https://doi.org/10.1111/rssa.12579">https://doi.org/10.1111/rssa.12579</a>.</p>
</div>
<div id="ref-phillippo_sensitivitytreatmentrecommendations_2018">
<p>Phillippo, David M., Sofia Dias, A. E. Ades, Vanessa Didelez, and Nicky J. Welton. 2018. “Sensitivity of Treatment Recommendations to Bias in Network Meta‐analysis.” <em>Journal of the Royal Statistical Society: Series A (Statistics in Society)</em> 181 (3): 843–67. <a href="https://doi.org/10.1111/rssa.12341">https://doi.org/10.1111/rssa.12341</a>.</p>
</div>
<div id="ref-phillippo_thresholdanalysisalternative_2019">
<p>Phillippo, David M., Sofia Dias, Nicky J. Welton, Deborah M. Caldwell, Nichole Taske, and A.e. Ades. 2019. “Threshold Analysis as an Alternative to GRADE for Assessing Confidence in Guideline Recommendations Based on Network Meta-Analyses.” <em>Annals of Internal Medicine</em> 170 (8): 538–46. <a href="https://doi.org/10.7326/M18-3542">https://doi.org/10.7326/M18-3542</a>.</p>
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="references">References</h3>
  <div id="references-listing"></div>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
